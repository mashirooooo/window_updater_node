import e,{createHash as t}from"crypto";import r,{basename as n,join as s,dirname as i}from"path";import o,{statSync as a,readFileSync as A,readdirSync as h,stat as l,createReadStream as u,createWriteStream as c,existsSync as p,mkdirSync as f,writeFileSync as d}from"fs";import{createGzip as m,createGunzip as v}from"zlib";import E,{spawn as g}from"child_process";import w from"os";import R from"util";var N="object"==typeof process&&process&&"win32"===process.platform?{sep:"\\"}:{sep:"/"},b=y;function y(e,t,r){e instanceof RegExp&&(e=I(e,r)),t instanceof RegExp&&(t=I(t,r));var n=O(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function I(e,t){var r=t.match(e);return r?r[0]:null}function O(e,t,r){var n,s,i,o,a,A=r.indexOf(e),h=r.indexOf(t,A+1),l=A;if(A>=0&&h>0){if(e===t)return[A,h];for(n=[],i=r.length;l>=0&&!a;)l==A?(n.push(l),A=r.indexOf(e,l+1)):1==n.length?a=[n.pop(),h]:((s=n.pop())<i&&(i=s,o=h),h=r.indexOf(t,l+1)),l=A<h&&A>=0?A:h;n.length&&(a=[i,o])}return a}y.range=O;var L=b,x=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return k(function(e){return e.split("\\\\").join(T).split("\\{").join(S).split("\\}").join(B).split("\\,").join(P).split("\\.").join(j)}(e),!0).map(V)},T="\0SLASH"+Math.random()+"\0",S="\0OPEN"+Math.random()+"\0",B="\0CLOSE"+Math.random()+"\0",P="\0COMMA"+Math.random()+"\0",j="\0PERIOD"+Math.random()+"\0";function C(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function V(e){return e.split(T).join("\\").split(S).join("{").split(B).join("}").split(P).join(",").split(j).join(".")}function D(e){if(!e)return[""];var t=[],r=L("{","}",e);if(!r)return e.split(",");var n=r.pre,s=r.body,i=r.post,o=n.split(",");o[o.length-1]+="{"+s+"}";var a=D(i);return i.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),t.push.apply(t,o),t}function F(e){return"{"+e+"}"}function $(e){return/^-?0\d/.test(e)}function U(e,t){return e<=t}function X(e,t){return e>=t}function k(e,t){var r=[],n=L("{","}",e);if(!n)return[e];var s=n.pre,i=n.post.length?k(n.post,!1):[""];if(/\$$/.test(n.pre))for(var o=0;o<i.length;o++){var a=s+"{"+n.body+"}"+i[o];r.push(a)}else{var A,h,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),c=l||u,p=n.body.indexOf(",")>=0;if(!c&&!p)return n.post.match(/,.*\}/)?k(e=n.pre+"{"+n.body+B+n.post):[e];if(c)A=n.body.split(/\.\./);else if(1===(A=D(n.body)).length&&1===(A=k(A[0],!1).map(F)).length)return i.map((function(e){return n.pre+A[0]+e}));if(c){var f=C(A[0]),d=C(A[1]),m=Math.max(A[0].length,A[1].length),v=3==A.length?Math.abs(C(A[2])):1,E=U;d<f&&(v*=-1,E=X);var g=A.some($);h=[];for(var w=f;E(w,d);w+=v){var R;if(u)"\\"===(R=String.fromCharCode(w))&&(R="");else if(R=String(w),g){var N=m-R.length;if(N>0){var b=new Array(N+1).join("0");R=w<0?"-"+b+R.slice(1):b+R}}h.push(R)}}else{h=[];for(var y=0;y<A.length;y++)h.push.apply(h,k(A[y],!1))}for(y=0;y<h.length;y++)for(o=0;o<i.length;o++){a=s+h[y]+i[o];(!t||c||a)&&r.push(a)}}return r}const Q=M=(e,t,r={})=>(ee(t),!(!r.nocomment&&"#"===t.charAt(0))&&new re(t,r).match(e));var M=Q;const Z=N;Q.sep=Z.sep;const z=Symbol("globstar **");Q.GLOBSTAR=z;const G=x,H={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},J=e=>e.split("").reduce(((e,t)=>(e[t]=!0,e)),{}),W=J("().*{}+?[]^$\\!"),Y=J("[.("),q=/\/+/;Q.filter=(e,t={})=>(r,n,s)=>Q(r,e,t);const K=(e,t={})=>{const r={};return Object.keys(e).forEach((t=>r[t]=e[t])),Object.keys(t).forEach((e=>r[e]=t[e])),r};Q.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return Q;const t=Q,r=(r,n,s)=>t(r,n,K(e,s));return(r.Minimatch=class extends t.Minimatch{constructor(t,r){super(t,K(e,r))}}).defaults=r=>t.defaults(K(e,r)).Minimatch,r.filter=(r,n)=>t.filter(r,K(e,n)),r.defaults=r=>t.defaults(K(e,r)),r.makeRe=(r,n)=>t.makeRe(r,K(e,n)),r.braceExpand=(r,n)=>t.braceExpand(r,K(e,n)),r.match=(r,n,s)=>t.match(r,n,K(e,s)),r},Q.braceExpand=(e,t)=>_(e,t);const _=(e,t={})=>(ee(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:G(e)),ee=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")},te=Symbol("subparse");Q.makeRe=(e,t)=>new re(e,t||{}).makeRe(),Q.match=(e,t,r={})=>{const n=new re(t,r);return e=e.filter((e=>n.match(e))),n.options.nonull&&!e.length&&e.push(t),e};class re{constructor(e,t){ee(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,r),r=this.globParts=r.map((e=>e.split(q))),this.debug(this.pattern,r),r=r.map(((e,t,r)=>e.map(this.parse,this))),this.debug(this.pattern,r),r=r.filter((e=>-1===e.indexOf(!1))),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,r=0;for(let n=0;n<e.length&&"!"===e.charAt(n);n++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}matchOne(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,i=0,o=e.length,a=t.length;s<o&&i<a;s++,i++){this.debug("matchOne loop");var A,h=t[i],l=e[s];if(this.debug(t,h,l),!1===h)return!1;if(h===z){this.debug("GLOBSTAR",[t,h,l]);var u=s,c=i+1;if(c===a){for(this.debug("** at the end");s<o;s++)if("."===e[s]||".."===e[s]||!n.dot&&"."===e[s].charAt(0))return!1;return!0}for(;u<o;){var p=e[u];if(this.debug("\nglobstar while",e,u,t,c,p),this.matchOne(e.slice(u),t.slice(c),r))return this.debug("globstar found match!",u,o,p),!0;if("."===p||".."===p||!n.dot&&"."===p.charAt(0)){this.debug("dot detected!",e,u,t,c);break}this.debug("globstar swallow a segment, and continue"),u++}return!(!r||(this.debug("\n>>> no match, partial?",e,u,t,c),u!==o))}if("string"==typeof h?(A=l===h,this.debug("string match",h,l,A)):(A=l.match(h),this.debug("pattern match",h,l,A)),!A)return!1}if(s===o&&i===a)return!0;if(s===o)return r;if(i===a)return s===o-1&&""===e[s];throw new Error("wtf?")}braceExpand(){return _(this.pattern,this.options)}parse(e,t){ee(e);const r=this.options;if("**"===e){if(!r.noglobstar)return z;e="*"}if(""===e)return"";let n="",s=!!r.nocase,i=!1;const o=[],a=[];let A,h,l,u,c=!1,p=-1,f=-1;const d="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",m=()=>{if(A){switch(A){case"*":n+="[^/]*?",s=!0;break;case"?":n+="[^/]",s=!0;break;default:n+="\\"+A}this.debug("clearStateChar %j %j",A,n),A=!1}};for(let t,d=0;d<e.length&&(t=e.charAt(d));d++)if(this.debug("%s\t%s %s %j",e,d,n,t),i){if("/"===t)return!1;W[t]&&(n+="\\"),n+=t,i=!1}else switch(t){case"/":return!1;case"\\":m(),i=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,d,n,t),c){this.debug("  in class"),"!"===t&&d===f+1&&(t="^"),n+=t;continue}this.debug("call clearStateChar %j",A),m(),A=t,r.noext&&m();continue;case"(":if(c){n+="(";continue}if(!A){n+="\\(";continue}o.push({type:A,start:d-1,reStart:n.length,open:H[A].open,close:H[A].close}),n+="!"===A?"(?:(?!(?:":"(?:",this.debug("plType %j %j",A,n),A=!1;continue;case")":if(c||!o.length){n+="\\)";continue}m(),s=!0,l=o.pop(),n+=l.close,"!"===l.type&&a.push(l),l.reEnd=n.length;continue;case"|":if(c||!o.length){n+="\\|";continue}m(),n+="|";continue;case"[":if(m(),c){n+="\\"+t;continue}c=!0,f=d,p=n.length,n+=t;continue;case"]":if(d===f+1||!c){n+="\\"+t;continue}h=e.substring(f+1,d);try{RegExp("["+h+"]")}catch(e){u=this.parse(h,te),n=n.substr(0,p)+"\\["+u[0]+"\\]",s=s||u[1],c=!1;continue}s=!0,c=!1,n+=t;continue;default:m(),!W[t]||"^"===t&&c||(n+="\\"),n+=t}for(c&&(h=e.substr(f+1),u=this.parse(h,te),n=n.substr(0,p)+"\\["+u[0],s=s||u[1]),l=o.pop();l;l=o.pop()){let e;e=n.slice(l.reStart+l.open.length),this.debug("setting tail",n,l),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,((e,t,r)=>(r||(r="\\"),t+t+r+"|"))),this.debug("tail=%j\n   %s",e,e,l,n);const t="*"===l.type?"[^/]*?":"?"===l.type?"[^/]":"\\"+l.type;s=!0,n=n.slice(0,l.reStart)+t+"\\("+e}m(),i&&(n+="\\\\");const v=Y[n.charAt(0)];for(let e=a.length-1;e>-1;e--){const r=a[e],s=n.slice(0,r.reStart),i=n.slice(r.reStart,r.reEnd-8);let o=n.slice(r.reEnd);const A=n.slice(r.reEnd-8,r.reEnd)+o,h=s.split("(").length-1;let l=o;for(let e=0;e<h;e++)l=l.replace(/\)[+*?]?/,"");o=l;n=s+i+o+(""===o&&t!==te?"$":"")+A}if(""!==n&&s&&(n="(?=.)"+n),v&&(n=d+n),t===te)return[n,s];if(!s)return e.replace(/\\(.)/g,"$1");const E=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+n+"$",E),{_glob:e,_src:n})}catch(e){return new RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,r=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"";let s=e.map((e=>(e=e.map((e=>"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===z?z:e._src)).reduce(((e,t)=>(e[e.length-1]===z&&t===z||e.push(t),e)),[]),e.forEach(((t,n)=>{t===z&&e[n-1]!==z&&(0===n?e.length>1?e[n+1]="(?:\\/|"+r+"\\/)?"+e[n+1]:e[n]=r:n===e.length-1?e[n-1]+="(?:\\/|"+r+")?":(e[n-1]+="(?:\\/|\\/"+r+"\\/)"+e[n+1],e[n+1]=z))})),e.filter((e=>e!==z)).join("/")))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,n)}catch(e){this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const r=this.options;"/"!==Z.sep&&(e=e.split(Z.sep).join("/")),e=e.split(q),this.debug(this.pattern,"split",e);const n=this.set;let s;this.debug(this.pattern,"set",n);for(let t=e.length-1;t>=0&&(s=e[t],!s);t--);for(let i=0;i<n.length;i++){const o=n[i];let a=e;r.matchBase&&1===o.length&&(a=[s]);if(this.matchOne(a,o,t))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}static defaults(e){return Q.defaults(e).Minimatch}}Q.Minimatch=re;class ne{}class se extends ne{}class ie{}class oe{constructor(){this.added=[],this.changed=[]}}class ae{constructor(){this.status="init",this.message=""}}var Ae;!function(e){e[e.HaveNothingUpdate=0]="HaveNothingUpdate",e[e.Success=1]="Success",e[e.Failed=2]="Failed"}(Ae||(Ae={}));class he{constructor(e,t){this.queue=[],this.activeCount=0,this.concurrency=e,this.onFinnish=t}async addTask(e){this.queue.push(e),this.run()}stop(){this.queue=[]}async run(){if(0===this.activeCount&&0===this.queue.length&&this.onFinnish&&this.onFinnish(),this.activeCount<this.concurrency&&this.queue.length>0){const e=this.queue.shift();this.activeCount++,e.task().then((t=>{e.taskReslove&&e.taskReslove(t)})).catch((t=>{e.taskReject&&e.taskReject(t)})).finally((()=>{this.activeCount--,this.run()}))}}}function le(e){return t("sha256").update(e).digest("hex")}function ue(e,t){if("function"==typeof e)return e(t);if(e&&Array.isArray(e)&&0!==e.length){return new RegExp(e.reduce(((e,t)=>e+"|"+M.makeRe(t).source),"").substring(1)).test(t)}return!1}function ce(e,t={}){var r,i;const o=a(e),l=n(e);if(o.isFile()){if(ue(null===(r=null==t?void 0:t.files)||void 0===r?void 0:r.exclude,l))return null;const n=new ne;return n.name=l,n.hash=le(A(e)),n}if(o.isDirectory()){if(ue(null===(i=null==t?void 0:t.folders)||void 0===i?void 0:i.exclude,l))return null;const r=new se;return r.name=l,r.children=h(e).map((r=>ce(s(e,r),t))).filter((e=>null!==e)),r.hash=le(r.children.map((e=>e.hash)).join("")),r}return null}function pe(e,r={},i=1){return new Promise(((o,a)=>{l(e,((A,l)=>{var c,p;if(A)a(A);else{const A=n(e);if(l.isFile()){if(ue(null===(c=null==r?void 0:r.files)||void 0===c?void 0:c.exclude,A))return o(null);const n=new ne;n.name=A;const s=u(e),i=t("sha256");s.pipe(i),s.on("end",(()=>{n.hash=i.digest("hex"),o(n),s.close()})),s.on("error",(e=>{a(e)}))}else{if(!l.isDirectory())return o(null);{if(ue(null===(p=null==r?void 0:r.folders)||void 0===p?void 0:p.exclude,A))return o(null);const t=new se;t.name=A;const n=h(e),l=[],u=new he(i,(()=>{t.children=l.filter((e=>null!==e)),t.hash=le(t.children.map((e=>e.hash)).join("")),o(t)}));for(const t of n)u.addTask({task:()=>pe(s(e,t),r),taskReslove:e=>{l.push(e)},taskReject:e=>{u.stop(),a(e)}})}}}}))}))}function fe(e){e&&e.children&&(e.childrenObject=e.children.reduce(((e,t)=>(t.children&&fe(t),e[t.name]=t,e)),{}))}function de(e,t,r=new oe,n="."){return t.hash===e.hash||(t.children?t.children.forEach((t=>{t=t,e.childrenObject&&e.childrenObject[t.name]?de(e.childrenObject[t.name],t,r,n+"/"+t.name):me(t,n+"/"+t.name,r.added)})):r.changed.push({filePath:n,hash:t.hash})),r}function me(e,t,r){e.children?e.children.forEach((e=>{me(e,t+"/"+e.name,r)})):r.push({filePath:t,hash:e.hash})}function ve(e,t){return new Promise(((r,n)=>{const s=m(),i=c(t),o=u(e);o.on("close",r),o.on("error",n),i.on("error",n),o.pipe(s).pipe(i)}))}async function Ee(e,t,r,n=!1){if(e.children)for(let s=0;s<e.children.length;s++)await Ee(e.children[s],t+(n?"":"/"+e.name),r);else await ve(t+"/"+e.name,s(r,e.hash+".gz"))}function ge(e,t){return new Promise((r=>{l(e,((n,s)=>{var i;r(!n&&(s.isFile()&&(null===(i=ce(e))||void 0===i?void 0:i.hash)===t))}))}))}function we(e,r,n,s){return new Promise(((i,o)=>{if(p(n)&&le(A(n))===e)i(!0);else{const a=t("sha256"),A=v(),h=c(n);s(r).then((t=>{t.pipe(A),t.once("error",(e=>{A.close(),h.close(),a.destroy(),o(e)})),A.pipe(a),A.pipe(h),A.on("end",(()=>{a.digest("hex")!==e?(a.destroy(),o(new Error("下载文件出错"))):(h.on("finish",(()=>{i(!0)})),h.end())}))}),(e=>{o(e)}))}}))}var Re={exports:{}};var Ne={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16};var be="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};!function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r}=Ne,n=be,s=(t=e.exports={}).re=[],i=t.src=[],o=t.t={};let a=0;const A=(e,t,r)=>{const A=a++;n(e,A,t),o[e]=A,i[A]=t,s[A]=new RegExp(t,r?"g":void 0)};A("NUMERICIDENTIFIER","0|[1-9]\\d*"),A("NUMERICIDENTIFIERLOOSE","[0-9]+"),A("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),A("MAINVERSION",`(${i[o.NUMERICIDENTIFIER]})\\.(${i[o.NUMERICIDENTIFIER]})\\.(${i[o.NUMERICIDENTIFIER]})`),A("MAINVERSIONLOOSE",`(${i[o.NUMERICIDENTIFIERLOOSE]})\\.(${i[o.NUMERICIDENTIFIERLOOSE]})\\.(${i[o.NUMERICIDENTIFIERLOOSE]})`),A("PRERELEASEIDENTIFIER",`(?:${i[o.NUMERICIDENTIFIER]}|${i[o.NONNUMERICIDENTIFIER]})`),A("PRERELEASEIDENTIFIERLOOSE",`(?:${i[o.NUMERICIDENTIFIERLOOSE]}|${i[o.NONNUMERICIDENTIFIER]})`),A("PRERELEASE",`(?:-(${i[o.PRERELEASEIDENTIFIER]}(?:\\.${i[o.PRERELEASEIDENTIFIER]})*))`),A("PRERELEASELOOSE",`(?:-?(${i[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${i[o.PRERELEASEIDENTIFIERLOOSE]})*))`),A("BUILDIDENTIFIER","[0-9A-Za-z-]+"),A("BUILD",`(?:\\+(${i[o.BUILDIDENTIFIER]}(?:\\.${i[o.BUILDIDENTIFIER]})*))`),A("FULLPLAIN",`v?${i[o.MAINVERSION]}${i[o.PRERELEASE]}?${i[o.BUILD]}?`),A("FULL",`^${i[o.FULLPLAIN]}$`),A("LOOSEPLAIN",`[v=\\s]*${i[o.MAINVERSIONLOOSE]}${i[o.PRERELEASELOOSE]}?${i[o.BUILD]}?`),A("LOOSE",`^${i[o.LOOSEPLAIN]}$`),A("GTLT","((?:<|>)?=?)"),A("XRANGEIDENTIFIERLOOSE",`${i[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),A("XRANGEIDENTIFIER",`${i[o.NUMERICIDENTIFIER]}|x|X|\\*`),A("XRANGEPLAIN",`[v=\\s]*(${i[o.XRANGEIDENTIFIER]})(?:\\.(${i[o.XRANGEIDENTIFIER]})(?:\\.(${i[o.XRANGEIDENTIFIER]})(?:${i[o.PRERELEASE]})?${i[o.BUILD]}?)?)?`),A("XRANGEPLAINLOOSE",`[v=\\s]*(${i[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${i[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${i[o.XRANGEIDENTIFIERLOOSE]})(?:${i[o.PRERELEASELOOSE]})?${i[o.BUILD]}?)?)?`),A("XRANGE",`^${i[o.GTLT]}\\s*${i[o.XRANGEPLAIN]}$`),A("XRANGELOOSE",`^${i[o.GTLT]}\\s*${i[o.XRANGEPLAINLOOSE]}$`),A("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),A("COERCERTL",i[o.COERCE],!0),A("LONETILDE","(?:~>?)"),A("TILDETRIM",`(\\s*)${i[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",A("TILDE",`^${i[o.LONETILDE]}${i[o.XRANGEPLAIN]}$`),A("TILDELOOSE",`^${i[o.LONETILDE]}${i[o.XRANGEPLAINLOOSE]}$`),A("LONECARET","(?:\\^)"),A("CARETTRIM",`(\\s*)${i[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",A("CARET",`^${i[o.LONECARET]}${i[o.XRANGEPLAIN]}$`),A("CARETLOOSE",`^${i[o.LONECARET]}${i[o.XRANGEPLAINLOOSE]}$`),A("COMPARATORLOOSE",`^${i[o.GTLT]}\\s*(${i[o.LOOSEPLAIN]})$|^$`),A("COMPARATOR",`^${i[o.GTLT]}\\s*(${i[o.FULLPLAIN]})$|^$`),A("COMPARATORTRIM",`(\\s*)${i[o.GTLT]}\\s*(${i[o.LOOSEPLAIN]}|${i[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",A("HYPHENRANGE",`^\\s*(${i[o.XRANGEPLAIN]})\\s+-\\s+(${i[o.XRANGEPLAIN]})\\s*$`),A("HYPHENRANGELOOSE",`^\\s*(${i[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${i[o.XRANGEPLAINLOOSE]})\\s*$`),A("STAR","(<|>)?=?\\s*\\*"),A("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),A("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Re,Re.exports);const ye=["includePrerelease","loose","rtl"];var Ie=e=>e?"object"!=typeof e?{loose:!0}:ye.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{};const Oe=/^[0-9]+$/,Le=(e,t)=>{const r=Oe.test(e),n=Oe.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1};var xe={compareIdentifiers:Le,rcompareIdentifiers:(e,t)=>Le(t,e)};const Te=be,{MAX_LENGTH:Se,MAX_SAFE_INTEGER:Be}=Ne,{re:Pe,t:je}=Re.exports,Ce=Ie,{compareIdentifiers:Ve}=xe;class De{constructor(e,t){if(t=Ce(t),e instanceof De){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>Se)throw new TypeError(`version is longer than ${Se} characters`);Te("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?Pe[je.LOOSE]:Pe[je.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Be||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Be||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Be||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<Be)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Te("SemVer.compare",this.version,this.options,e),!(e instanceof De)){if("string"==typeof e&&e===this.version)return 0;e=new De(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof De||(e=new De(e,this.options)),Ve(this.major,e.major)||Ve(this.minor,e.minor)||Ve(this.patch,e.patch)}comparePre(e){if(e instanceof De||(e=new De(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],n=e.prerelease[t];if(Te("prerelease compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return Ve(r,n)}while(++t)}compareBuild(e){e instanceof De||(e=new De(e,this.options));let t=0;do{const r=this.build[t],n=e.build[t];if(Te("prerelease compare",t,r,n),void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return Ve(r,n)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(0===Ve(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}var Fe=De;const{MAX_LENGTH:$e}=Ne,{re:Ue,t:Xe}=Re.exports,ke=Fe,Qe=Ie;var Me=(e,t)=>{if(t=Qe(t),e instanceof ke)return e;if("string"!=typeof e)return null;if(e.length>$e)return null;if(!(t.loose?Ue[Xe.LOOSE]:Ue[Xe.FULL]).test(e))return null;try{return new ke(e,t)}catch(e){return null}};const Ze=Me;var ze=(e,t)=>{const r=Ze(e,t);return r?r.version:null};const Ge=Me;var He=(e,t)=>{const r=Ge(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};const Je=Fe;var We=(e,t,r,n)=>{"string"==typeof r&&(n=r,r=void 0);try{return new Je(e instanceof Je?e.version:e,r).inc(t,n).version}catch(e){return null}};const Ye=Fe;var qe=(e,t,r)=>new Ye(e,r).compare(new Ye(t,r));const Ke=qe;var _e=(e,t,r)=>0===Ke(e,t,r);const et=Me,tt=_e;var rt=(e,t)=>{if(tt(e,t))return null;{const r=et(e),n=et(t),s=r.prerelease.length||n.prerelease.length,i=s?"pre":"",o=s?"prerelease":"";for(const e in r)if(("major"===e||"minor"===e||"patch"===e)&&r[e]!==n[e])return i+e;return o}};const nt=Fe;var st=(e,t)=>new nt(e,t).major;const it=Fe;var ot=(e,t)=>new it(e,t).minor;const at=Fe;var At=(e,t)=>new at(e,t).patch;const ht=Me;var lt=(e,t)=>{const r=ht(e,t);return r&&r.prerelease.length?r.prerelease:null};const ut=qe;var ct=(e,t,r)=>ut(t,e,r);const pt=qe;var ft=(e,t)=>pt(e,t,!0);const dt=Fe;var mt=(e,t,r)=>{const n=new dt(e,r),s=new dt(t,r);return n.compare(s)||n.compareBuild(s)};const vt=mt;var Et=(e,t)=>e.sort(((e,r)=>vt(e,r,t)));const gt=mt;var wt=(e,t)=>e.sort(((e,r)=>gt(r,e,t)));const Rt=qe;var Nt=(e,t,r)=>Rt(e,t,r)>0;const bt=qe;var yt=(e,t,r)=>bt(e,t,r)<0;const It=qe;var Ot=(e,t,r)=>0!==It(e,t,r);const Lt=qe;var xt=(e,t,r)=>Lt(e,t,r)>=0;const Tt=qe;var St=(e,t,r)=>Tt(e,t,r)<=0;const Bt=_e,Pt=Ot,jt=Nt,Ct=xt,Vt=yt,Dt=St;var Ft=(e,t,r,n)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return Bt(e,r,n);case"!=":return Pt(e,r,n);case">":return jt(e,r,n);case">=":return Ct(e,r,n);case"<":return Vt(e,r,n);case"<=":return Dt(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};const $t=Fe,Ut=Me,{re:Xt,t:kt}=Re.exports;var Qt=(e,t)=>{if(e instanceof $t)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=Xt[kt.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),Xt[kt.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;Xt[kt.COERCERTL].lastIndex=-1}else r=e.match(Xt[kt.COERCE]);return null===r?null:Ut(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)},Mt=Zt;function Zt(e){var t=this;if(t instanceof Zt||(t=new Zt),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}function zt(e,t,r){var n=t===e.head?new Jt(r,null,t,e):new Jt(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function Gt(e,t){e.tail=new Jt(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Ht(e,t){e.head=new Jt(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Jt(e,t,r,n){if(!(this instanceof Jt))return new Jt(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}Zt.Node=Jt,Zt.create=Zt,Zt.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Zt.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Zt.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Zt.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Gt(this,arguments[e]);return this.length},Zt.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)Ht(this,arguments[e]);return this.length},Zt.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Zt.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Zt.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},Zt.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},Zt.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},Zt.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},Zt.prototype.map=function(e,t){t=t||this;for(var r=new Zt,n=this.head;null!==n;)r.push(e.call(t,n.value,this)),n=n.next;return r},Zt.prototype.mapReverse=function(e,t){t=t||this;for(var r=new Zt,n=this.tail;null!==n;)r.push(e.call(t,n.value,this)),n=n.prev;return r},Zt.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var s=0;null!==n;s++)r=e(r,n.value,s),n=n.next;return r},Zt.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var s=this.length-1;null!==n;s--)r=e(r,n.value,s),n=n.prev;return r},Zt.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},Zt.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},Zt.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new Zt;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,s=this.head;null!==s&&n<e;n++)s=s.next;for(;null!==s&&n<t;n++,s=s.next)r.push(s.value);return r},Zt.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new Zt;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,s=this.tail;null!==s&&n>t;n--)s=s.prev;for(;null!==s&&n>e;n--,s=s.prev)r.push(s.value);return r},Zt.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,s=this.head;null!==s&&n<e;n++)s=s.next;var i=[];for(n=0;s&&n<t;n++)i.push(s.value),s=this.removeNode(s);null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(n=0;n<r.length;n++)s=zt(this,s,r[n]);return i},Zt.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{require("./iterator.js")(Zt)}catch(e){}const Wt=Mt,Yt=Symbol("max"),qt=Symbol("length"),Kt=Symbol("lengthCalculator"),_t=Symbol("allowStale"),er=Symbol("maxAge"),tr=Symbol("dispose"),rr=Symbol("noDisposeOnSet"),nr=Symbol("lruList"),sr=Symbol("cache"),ir=Symbol("updateAgeOnGet"),or=()=>1;const ar=(e,t,r)=>{const n=e[sr].get(t);if(n){const t=n.value;if(Ar(e,t)){if(lr(e,n),!e[_t])return}else r&&(e[ir]&&(n.value.now=Date.now()),e[nr].unshiftNode(n));return t.value}},Ar=(e,t)=>{if(!t||!t.maxAge&&!e[er])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[er]&&r>e[er]},hr=e=>{if(e[qt]>e[Yt])for(let t=e[nr].tail;e[qt]>e[Yt]&&null!==t;){const r=t.prev;lr(e,t),t=r}},lr=(e,t)=>{if(t){const r=t.value;e[tr]&&e[tr](r.key,r.value),e[qt]-=r.length,e[sr].delete(r.key),e[nr].removeNode(t)}};class ur{constructor(e,t,r,n,s){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=s||0}}const cr=(e,t,r,n)=>{let s=r.value;Ar(e,s)&&(lr(e,r),e[_t]||(s=void 0)),s&&t.call(n,s.value,s.key,e)};var pr=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[Yt]=e.max||1/0;const t=e.length||or;if(this[Kt]="function"!=typeof t?or:t,this[_t]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[er]=e.maxAge||0,this[tr]=e.dispose,this[rr]=e.noDisposeOnSet||!1,this[ir]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[Yt]=e||1/0,hr(this)}get max(){return this[Yt]}set allowStale(e){this[_t]=!!e}get allowStale(){return this[_t]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[er]=e,hr(this)}get maxAge(){return this[er]}set lengthCalculator(e){"function"!=typeof e&&(e=or),e!==this[Kt]&&(this[Kt]=e,this[qt]=0,this[nr].forEach((e=>{e.length=this[Kt](e.value,e.key),this[qt]+=e.length}))),hr(this)}get lengthCalculator(){return this[Kt]}get length(){return this[qt]}get itemCount(){return this[nr].length}rforEach(e,t){t=t||this;for(let r=this[nr].tail;null!==r;){const n=r.prev;cr(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[nr].head;null!==r;){const n=r.next;cr(this,e,r,t),r=n}}keys(){return this[nr].toArray().map((e=>e.key))}values(){return this[nr].toArray().map((e=>e.value))}reset(){this[tr]&&this[nr]&&this[nr].length&&this[nr].forEach((e=>this[tr](e.key,e.value))),this[sr]=new Map,this[nr]=new Wt,this[qt]=0}dump(){return this[nr].map((e=>!Ar(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[nr]}set(e,t,r){if((r=r||this[er])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,s=this[Kt](t,e);if(this[sr].has(e)){if(s>this[Yt])return lr(this,this[sr].get(e)),!1;const i=this[sr].get(e).value;return this[tr]&&(this[rr]||this[tr](e,i.value)),i.now=n,i.maxAge=r,i.value=t,this[qt]+=s-i.length,i.length=s,this.get(e),hr(this),!0}const i=new ur(e,t,s,n,r);return i.length>this[Yt]?(this[tr]&&this[tr](e,t),!1):(this[qt]+=i.length,this[nr].unshift(i),this[sr].set(e,this[nr].head),hr(this),!0)}has(e){if(!this[sr].has(e))return!1;const t=this[sr].get(e).value;return!Ar(this,t)}get(e){return ar(this,e,!0)}peek(e){return ar(this,e,!1)}pop(){const e=this[nr].tail;return e?(lr(this,e),e.value):null}del(e){lr(this,this[sr].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],s=n.e||0;if(0===s)this.set(n.k,n.v);else{const e=s-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[sr].forEach(((e,t)=>ar(this,t,!1)))}};class fr{constructor(e,t){if(t=vr(t),e instanceof fr)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new fr(e.raw,t);if(e instanceof Er)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!Or(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&Lr(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,r=mr.get(t);if(r)return r;const n=this.options.loose,s=n?Rr[Nr.HYPHENRANGELOOSE]:Rr[Nr.HYPHENRANGE];e=e.replace(s,Ur(this.options.includePrerelease)),gr("hyphen replace",e),e=e.replace(Rr[Nr.COMPARATORTRIM],br),gr("comparator trim",e);let i=(e=(e=(e=e.replace(Rr[Nr.TILDETRIM],yr)).replace(Rr[Nr.CARETTRIM],Ir)).split(/\s+/).join(" ")).split(" ").map((e=>Tr(e,this.options))).join(" ").split(/\s+/).map((e=>$r(e,this.options)));n&&(i=i.filter((e=>(gr("loose invalid filter",e,this.options),!!e.match(Rr[Nr.COMPARATORLOOSE]))))),gr("range list",i);const o=new Map,a=i.map((e=>new Er(e,this.options)));for(const e of a){if(Or(e))return[e];o.set(e.value,e)}o.size>1&&o.has("")&&o.delete("");const A=[...o.values()];return mr.set(t,A),A}intersects(e,t){if(!(e instanceof fr))throw new TypeError("a Range is required");return this.set.some((r=>xr(r,t)&&e.set.some((e=>xr(e,t)&&r.every((r=>e.every((e=>r.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new wr(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(Xr(this.set[t],e,this.options))return!0;return!1}}var dr=fr;const mr=new pr({max:1e3}),vr=Ie,Er=Mr,gr=be,wr=Fe,{re:Rr,t:Nr,comparatorTrimReplace:br,tildeTrimReplace:yr,caretTrimReplace:Ir}=Re.exports,Or=e=>"<0.0.0-0"===e.value,Lr=e=>""===e.value,xr=(e,t)=>{let r=!0;const n=e.slice();let s=n.pop();for(;r&&n.length;)r=n.every((e=>s.intersects(e,t))),s=n.pop();return r},Tr=(e,t)=>(gr("comp",e,t),e=jr(e,t),gr("caret",e),e=Br(e,t),gr("tildes",e),e=Vr(e,t),gr("xrange",e),e=Fr(e,t),gr("stars",e),e),Sr=e=>!e||"x"===e.toLowerCase()||"*"===e,Br=(e,t)=>e.trim().split(/\s+/).map((e=>Pr(e,t))).join(" "),Pr=(e,t)=>{const r=t.loose?Rr[Nr.TILDELOOSE]:Rr[Nr.TILDE];return e.replace(r,((t,r,n,s,i)=>{let o;return gr("tilde",e,t,r,n,s,i),Sr(r)?o="":Sr(n)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:Sr(s)?o=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:i?(gr("replaceTilde pr",i),o=`>=${r}.${n}.${s}-${i} <${r}.${+n+1}.0-0`):o=`>=${r}.${n}.${s} <${r}.${+n+1}.0-0`,gr("tilde return",o),o}))},jr=(e,t)=>e.trim().split(/\s+/).map((e=>Cr(e,t))).join(" "),Cr=(e,t)=>{gr("caret",e,t);const r=t.loose?Rr[Nr.CARETLOOSE]:Rr[Nr.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,s,i,o)=>{let a;return gr("caret",e,t,r,s,i,o),Sr(r)?a="":Sr(s)?a=`>=${r}.0.0${n} <${+r+1}.0.0-0`:Sr(i)?a="0"===r?`>=${r}.${s}.0${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.0${n} <${+r+1}.0.0-0`:o?(gr("replaceCaret pr",o),a="0"===r?"0"===s?`>=${r}.${s}.${i}-${o} <${r}.${s}.${+i+1}-0`:`>=${r}.${s}.${i}-${o} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${i}-${o} <${+r+1}.0.0-0`):(gr("no pr"),a="0"===r?"0"===s?`>=${r}.${s}.${i}${n} <${r}.${s}.${+i+1}-0`:`>=${r}.${s}.${i}${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${i} <${+r+1}.0.0-0`),gr("caret return",a),a}))},Vr=(e,t)=>(gr("replaceXRanges",e,t),e.split(/\s+/).map((e=>Dr(e,t))).join(" ")),Dr=(e,t)=>{e=e.trim();const r=t.loose?Rr[Nr.XRANGELOOSE]:Rr[Nr.XRANGE];return e.replace(r,((r,n,s,i,o,a)=>{gr("xRange",e,r,n,s,i,o,a);const A=Sr(s),h=A||Sr(i),l=h||Sr(o),u=l;return"="===n&&u&&(n=""),a=t.includePrerelease?"-0":"",A?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&u?(h&&(i=0),o=0,">"===n?(n=">=",h?(s=+s+1,i=0,o=0):(i=+i+1,o=0)):"<="===n&&(n="<",h?s=+s+1:i=+i+1),"<"===n&&(a="-0"),r=`${n+s}.${i}.${o}${a}`):h?r=`>=${s}.0.0${a} <${+s+1}.0.0-0`:l&&(r=`>=${s}.${i}.0${a} <${s}.${+i+1}.0-0`),gr("xRange return",r),r}))},Fr=(e,t)=>(gr("replaceStars",e,t),e.trim().replace(Rr[Nr.STAR],"")),$r=(e,t)=>(gr("replaceGTE0",e,t),e.trim().replace(Rr[t.includePrerelease?Nr.GTE0PRE:Nr.GTE0],"")),Ur=e=>(t,r,n,s,i,o,a,A,h,l,u,c,p)=>`${r=Sr(n)?"":Sr(s)?`>=${n}.0.0${e?"-0":""}`:Sr(i)?`>=${n}.${s}.0${e?"-0":""}`:o?`>=${r}`:`>=${r}${e?"-0":""}`} ${A=Sr(h)?"":Sr(l)?`<${+h+1}.0.0-0`:Sr(u)?`<${h}.${+l+1}.0-0`:c?`<=${h}.${l}.${u}-${c}`:e?`<${h}.${l}.${+u+1}-0`:`<=${A}`}`.trim(),Xr=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(gr(e[r].semver),e[r].semver!==Er.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0},kr=Symbol("SemVer ANY");class Qr{static get ANY(){return kr}constructor(e,t){if(t=Zr(t),e instanceof Qr){if(e.loose===!!t.loose)return e;e=e.value}Jr("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===kr?this.value="":this.value=this.operator+this.semver.version,Jr("comp",this)}parse(e){const t=this.options.loose?zr[Gr.COMPARATORLOOSE]:zr[Gr.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new Wr(r[2],this.options.loose):this.semver=kr}toString(){return this.value}test(e){if(Jr("Comparator.test",e,this.options.loose),this.semver===kr||e===kr)return!0;if("string"==typeof e)try{e=new Wr(e,this.options)}catch(e){return!1}return Hr(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Qr))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new Yr(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new Yr(this.value,t).test(e.semver);const r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,i=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),o=Hr(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),a=Hr(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||n||s&&i||o||a}}var Mr=Qr;const Zr=Ie,{re:zr,t:Gr}=Re.exports,Hr=Ft,Jr=be,Wr=Fe,Yr=dr,qr=dr;var Kr=(e,t,r)=>{try{t=new qr(t,r)}catch(e){return!1}return t.test(e)};const _r=dr;var en=(e,t)=>new _r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")));const tn=Fe,rn=dr;var nn=(e,t,r)=>{let n=null,s=null,i=null;try{i=new rn(t,r)}catch(e){return null}return e.forEach((e=>{i.test(e)&&(n&&-1!==s.compare(e)||(n=e,s=new tn(n,r)))})),n};const sn=Fe,on=dr;var an=(e,t,r)=>{let n=null,s=null,i=null;try{i=new on(t,r)}catch(e){return null}return e.forEach((e=>{i.test(e)&&(n&&1!==s.compare(e)||(n=e,s=new sn(n,r)))})),n};const An=Fe,hn=dr,ln=Nt;var un=(e,t)=>{e=new hn(e,t);let r=new An("0.0.0");if(e.test(r))return r;if(r=new An("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const n=e.set[t];let s=null;n.forEach((e=>{const t=new An(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!ln(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||r&&!ln(r,s)||(r=s)}return r&&e.test(r)?r:null};const cn=dr;var pn=(e,t)=>{try{return new cn(e,t).range||"*"}catch(e){return null}};const fn=Fe,dn=Mr,{ANY:mn}=dn,vn=dr,En=Kr,gn=Nt,wn=yt,Rn=St,Nn=xt;var bn=(e,t,r,n)=>{let s,i,o,a,A;switch(e=new fn(e,n),t=new vn(t,n),r){case">":s=gn,i=Rn,o=wn,a=">",A=">=";break;case"<":s=wn,i=Nn,o=gn,a="<",A="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(En(e,t,n))return!1;for(let r=0;r<t.set.length;++r){const h=t.set[r];let l=null,u=null;if(h.forEach((e=>{e.semver===mn&&(e=new dn(">=0.0.0")),l=l||e,u=u||e,s(e.semver,l.semver,n)?l=e:o(e.semver,u.semver,n)&&(u=e)})),l.operator===a||l.operator===A)return!1;if((!u.operator||u.operator===a)&&i(e,u.semver))return!1;if(u.operator===A&&o(e,u.semver))return!1}return!0};const yn=bn;var In=(e,t,r)=>yn(e,t,">",r);const On=bn;var Ln=(e,t,r)=>On(e,t,"<",r);const xn=dr;var Tn=(e,t,r)=>(e=new xn(e,r),t=new xn(t,r),e.intersects(t));const Sn=Kr,Bn=qe;const Pn=dr,jn=Mr,{ANY:Cn}=jn,Vn=Kr,Dn=qe,Fn=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===Cn){if(1===t.length&&t[0].semver===Cn)return!0;e=r.includePrerelease?[new jn(">=0.0.0-0")]:[new jn(">=0.0.0")]}if(1===t.length&&t[0].semver===Cn){if(r.includePrerelease)return!0;t=[new jn(">=0.0.0")]}const n=new Set;let s,i,o,a,A,h,l;for(const t of e)">"===t.operator||">="===t.operator?s=$n(s,t,r):"<"===t.operator||"<="===t.operator?i=Un(i,t,r):n.add(t.semver);if(n.size>1)return null;if(s&&i){if(o=Dn(s.semver,i.semver,r),o>0)return null;if(0===o&&(">="!==s.operator||"<="!==i.operator))return null}for(const e of n){if(s&&!Vn(e,String(s),r))return null;if(i&&!Vn(e,String(i),r))return null;for(const n of t)if(!Vn(e,String(n),r))return!1;return!0}let u=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver,c=!(!s||r.includePrerelease||!s.semver.prerelease.length)&&s.semver;u&&1===u.prerelease.length&&"<"===i.operator&&0===u.prerelease[0]&&(u=!1);for(const e of t){if(l=l||">"===e.operator||">="===e.operator,h=h||"<"===e.operator||"<="===e.operator,s)if(c&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===c.major&&e.semver.minor===c.minor&&e.semver.patch===c.patch&&(c=!1),">"===e.operator||">="===e.operator){if(a=$n(s,e,r),a===e&&a!==s)return!1}else if(">="===s.operator&&!Vn(s.semver,String(e),r))return!1;if(i)if(u&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===u.major&&e.semver.minor===u.minor&&e.semver.patch===u.patch&&(u=!1),"<"===e.operator||"<="===e.operator){if(A=Un(i,e,r),A===e&&A!==i)return!1}else if("<="===i.operator&&!Vn(i.semver,String(e),r))return!1;if(!e.operator&&(i||s)&&0!==o)return!1}return!(s&&h&&!i&&0!==o)&&(!(i&&l&&!s&&0!==o)&&(!c&&!u))},$n=(e,t,r)=>{if(!e)return t;const n=Dn(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},Un=(e,t,r)=>{if(!e)return t;const n=Dn(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};const Xn=Re.exports,kn=Ne,Qn=xe,Mn=(e,t,r)=>{const n=[];let s=null,i=null;const o=e.sort(((e,t)=>Bn(e,t,r)));for(const e of o){Sn(e,t,r)?(i=e,s||(s=e)):(i&&n.push([s,i]),i=null,s=null)}s&&n.push([s,null]);const a=[];for(const[e,t]of n)e===t?a.push(e):t||e!==o[0]?t?e===o[0]?a.push(`<=${t}`):a.push(`${e} - ${t}`):a.push(`>=${e}`):a.push("*");const A=a.join(" || "),h="string"==typeof t.raw?t.raw:String(t);return A.length<h.length?A:t};var Zn={parse:Me,valid:ze,clean:He,inc:We,diff:rt,major:st,minor:ot,patch:At,prerelease:lt,compare:qe,rcompare:ct,compareLoose:ft,compareBuild:mt,sort:Et,rsort:wt,gt:Nt,lt:yt,eq:_e,neq:Ot,gte:xt,lte:St,cmp:Ft,coerce:Qt,Comparator:Mr,Range:dr,satisfies:Kr,toComparators:en,maxSatisfying:nn,minSatisfying:an,minVersion:un,validRange:pn,outside:bn,gtr:In,ltr:Ln,intersects:Tn,simplifyRange:Mn,subset:(e,t,r={})=>{if(e===t)return!0;e=new Pn(e,r),t=new Pn(t,r);let n=!1;e:for(const s of e.set){for(const e of t.set){const t=Fn(s,e,r);if(n=n||null!==t,t)continue e}if(n)return!1}return!0},SemVer:Fe,re:Xn.re,src:Xn.src,tokens:Xn.t,SEMVER_SPEC_VERSION:kn.SEMVER_SPEC_VERSION,compareIdentifiers:Qn.compareIdentifiers,rcompareIdentifiers:Qn.rcompareIdentifiers},zn={},Gn={child:E,crypto:e,fs:o,os:w,path:r,process:process,util:R};function Hn(e,t){var r=Gn.process.platform;return"darwin"===r?function(e,t){var r=Gn.os.tmpdir();if(!r)return t(new Error("os.tmpdir() not defined."));if(!Gn.process.env.USER)return t(new Error("env['USER'] not defined."));Yn(e,(function(n,s){if(n)return t(n);function i(r,n,s){Wn(Gn.path.dirname(e.path),(function(e){return r?t(r):e?t(e):void t(void 0,n,s)}))}e.uuid=s,e.path=Gn.path.join(r,e.uuid,e.options.name+".app"),function(e,t){var r=Gn.path.dirname(e.path);Gn.fs.mkdir(r,(function(n){if(n)return t(n);var s=Gn.path.join(r,"sudo-prompt-applet.zip");Gn.fs.writeFile(s,_n,"base64",(function(r){if(r)return t(r);var n=[];n.push("/usr/bin/unzip"),n.push("-o"),n.push('"'+Jn(s)+'"'),n.push('-d "'+Jn(e.path)+'"'),n=n.join(" "),Gn.child.exec(n,{encoding:"utf-8"},t)}))}))}(e,(function(t,r,n){if(t)return i(t,r,n);!function(e,t){if(!e.options.icns)return t();Gn.fs.readFile(e.options.icns,(function(r,n){if(r)return t(r);var s=Gn.path.join(e.path,"Contents","Resources","applet.icns");Gn.fs.writeFile(s,n,t)}))}(e,(function(t){if(t)return i(t);!function(e,t){var r=Jn(Gn.path.join(e.path,"Contents","Info.plist")),n=Jn("CFBundleName"),s=e.options.name+" Password Prompt";if(/'/.test(s))return t(new Error("Value should not contain single quotes."));var i=[];i.push("/usr/bin/defaults"),i.push("write"),i.push('"'+r+'"'),i.push('"'+n+'"'),i.push("'"+s+"'"),i=i.join(" "),Gn.child.exec(i,{encoding:"utf-8"},t)}(e,(function(t,r,n){if(t)return i(t,r,n);!function(e,t){var r=Gn.path.join(e.path,"Contents","MacOS","sudo-prompt-command"),n=[];for(var s in n.push('cd "'+Jn(Gn.process.cwd())+'"'),e.options.env){var i=e.options.env[s];n.push("export "+s+'="'+Jn(i)+'"')}n.push(e.command),n=n.join("\n"),Gn.fs.writeFile(r,n,"utf-8",t)}(e,(function(t){if(t)return i(t);!function(e,t){var r=Gn.path.join(e.path,"Contents","MacOS","applet"),n={cwd:Gn.path.dirname(r),encoding:"utf-8"};Gn.child.exec("./"+Gn.path.basename(r),n,t)}(e,(function(t,r,n){if(t)return i(t,r,n);!function(e,t){var r=Gn.path.join(e.path,"Contents","MacOS");Gn.fs.readFile(Gn.path.join(r,"code"),"utf-8",(function(n,s){if(n){if("ENOENT"===n.code)return t(new Error(es));t(n)}else Gn.fs.readFile(Gn.path.join(r,"stdout"),"utf-8",(function(n,i){if(n)return t(n);Gn.fs.readFile(Gn.path.join(r,"stderr"),"utf-8",(function(r,n){if(r)return t(r);0===(s=parseInt(s.trim(),10))?t(void 0,i,n):((r=new Error("Command failed: "+e.command+"\n"+n)).code=s,t(r,i,n))}))}))}))}(e,i)}))}))}))}))}))}))}(e,t):"linux"===r?function(e,t){!function(e,t){var r=0,n=["/usr/bin/kdesudo","/usr/bin/pkexec"];function s(){if(r===n.length)return t(new Error("Unable to find pkexec or kdesudo."));var e=n[r++];Gn.fs.stat(e,(function(r){if(r){if("ENOTDIR"===r.code)return s();if("ENOENT"===r.code)return s();t(r)}else t(void 0,e)}))}s()}(0,(function(r,n){if(r)return t(r);var s=[];for(var i in s.push('cd "'+Jn(Gn.process.cwd())+'";'),e.options.env){var o=e.options.env[i];s.push("export "+i+'="'+Jn(o)+'";')}s.push('"'+Jn(n)+'"'),/kdesudo/i.test(n)?(s.push("--comment",'"'+e.options.name+' wants to make changes. Enter your password to allow this."'),s.push("-d"),s.push("--")):/pkexec/i.test(n)&&s.push("--disable-internal-agent");var a="SUDOPROMPT\n";s.push('/bin/bash -c "echo '+Jn(a.trim())+"; "+Jn(e.command)+'"'),s=s.join(" "),Gn.child.exec(s,{encoding:"utf-8",maxBuffer:rs},(function(e,r,n){var s=r&&r.slice(0,a.length)===a;s&&(r=r.slice(a.length)),e&&!s&&(/No authentication agent found/.test(n)?e.message=ts:e.message=es),t(e,r,n)}))}))}(e,t):"win32"===r?function(e,t){var r=Gn.os.tmpdir();if(!r)return t(new Error("os.tmpdir() not defined."));Yn(e,(function(n,s){return n?t(n):(e.uuid=s,e.path=Gn.path.join(r,e.uuid),/"/.test(e.path)?t(new Error("instance.path cannot contain double-quotes.")):(e.pathElevate=Gn.path.join(e.path,"elevate.vbs"),e.pathExecute=Gn.path.join(e.path,"execute.bat"),e.pathCommand=Gn.path.join(e.path,"command.bat"),e.pathStdout=Gn.path.join(e.path,"stdout"),e.pathStderr=Gn.path.join(e.path,"stderr"),e.pathStatus=Gn.path.join(e.path,"status"),void Gn.fs.mkdir(e.path,(function(r){if(r)return t(r);function n(r,n,s){Wn(e.path,(function(e){return r?t(r):e?t(e):void t(void 0,n,s)}))}!function(e,t){var r=[];r.push("@echo off"),r.push('call "'+e.pathCommand+'" > "'+e.pathStdout+'" 2> "'+e.pathStderr+'"'),r.push('(echo %ERRORLEVEL%) > "'+e.pathStatus+'"'),r=r.join("\r\n"),Gn.fs.writeFile(e.pathExecute,r,"utf-8",t)}(e,(function(t){if(t)return n(t);!function(e,t){var r=Gn.process.cwd();if(/"/.test(r))return t(new Error("process.cwd() cannot contain double-quotes."));var n=[];for(var s in n.push("@echo off"),n.push("chcp 65001>nul"),n.push('cd /d "'+r+'"'),e.options.env){var i=e.options.env[s];n.push("set "+s+"="+i.replace(/([<>\\|&^])/g,"^$1"))}n.push(e.command),n=n.join("\r\n"),Gn.fs.writeFile(e.pathCommand,n,"utf-8",t)}(e,(function(t){if(t)return n(t);!function(e,t){var r=[];r.push("powershell.exe"),r.push("Start-Process"),r.push("-FilePath"),r.push("\"'"+e.pathExecute.replace(/'/g,"`'")+"'\""),r.push("-WindowStyle hidden"),r.push("-Verb runAs"),r=r.join(" ");var n=Gn.child.exec(r,{encoding:"utf-8"},(function(e,r,n){if(e)return t(new Error(es),r,n);t()}));n.stdin.end()}(e,(function(t,r,s){if(t)return n(t,r,s);Kn(e,(function(t){if(t)return n(t);!function(e,t){Gn.fs.readFile(e.pathStatus,"utf-8",(function(r,n){if(r)return t(r);Gn.fs.readFile(e.pathStdout,"utf-8",(function(r,s){if(r)return t(r);Gn.fs.readFile(e.pathStderr,"utf-8",(function(r,i){if(r)return t(r);0===(n=parseInt(n.trim(),10))?t(void 0,s,i):((r=new Error("Command failed: "+e.command+"\r\n"+i)).code=n,t(r,s,i))}))}))}))}(e,n)}))}))}))}))}))))}))}(e,t):void t(new Error("Platform not yet supported."))}function Jn(e){if("string"!=typeof e)throw new Error("Expected a string.");return e.replace(/"/g,'\\"')}function Wn(e,t){if("string"!=typeof e||!e.trim())return t(new Error("Argument path not defined."));var r=[];if("win32"===Gn.process.platform){if(/"/.test(e))return t(new Error("Argument path cannot contain double-quotes."));r.push('rmdir /s /q "'+e+'"')}else r.push("/bin/rm"),r.push("-rf"),r.push('"'+Jn(Gn.path.normalize(e))+'"');r=r.join(" "),Gn.child.exec(r,{encoding:"utf-8"},t)}function Yn(e,t){Gn.crypto.randomBytes(256,(function(r,n){r&&(n=Date.now()+""+Math.random());var s=Gn.crypto.createHash("SHA256");s.update("sudo-prompt-3"),s.update(e.options.name),s.update(e.command),s.update(n);var i=s.digest("hex").slice(-32);if(!i||"string"!=typeof i||32!==i.length)return t(new Error("Expected a valid UUID."));t(void 0,i)}))}function qn(e){return!!/^[a-z0-9 ]+$/i.test(e)&&(0!==e.trim().length&&!(e.length>70))}function Kn(e,t){Gn.fs.stat(e.pathStatus,(function(r,n){r&&"ENOENT"===r.code||n.size<2?setTimeout((function(){Gn.fs.stat(e.pathStdout,(function(r){if(r)return t(new Error(es));Kn(e,t)}))}),1e3):r?t(r):t()}))}zn.exec=function(){if(arguments.length<1||arguments.length>3)throw new Error("Wrong number of arguments.");var e=arguments[0],t={},r=function(){};if("string"!=typeof e)throw new Error("Command should be a string.");if(2===arguments.length)if(Gn.util.isObject(arguments[1]))t=arguments[1];else{if(!Gn.util.isFunction(arguments[1]))throw new Error("Expected options or callback.");r=arguments[1]}else if(3===arguments.length){if(!Gn.util.isObject(arguments[1]))throw new Error("Expected options to be an object.");if(t=arguments[1],!Gn.util.isFunction(arguments[2]))throw new Error("Expected callback to be a function.");r=arguments[2]}if(/^sudo/i.test(e))return r(new Error('Command should not be prefixed with "sudo".'));if(void 0===t.name){var n=Gn.process.title;if(!qn(n))return r(new Error("process.title cannot be used as a valid name."));t.name=n}else if(!qn(t.name)){var s="";return s+="options.name must be alphanumeric only ",s+="(spaces are allowed) and <= 70 characters.",r(new Error(s))}if(void 0!==t.icns){if("string"!=typeof t.icns)return r(new Error("options.icns must be a string if provided."));if(0===t.icns.trim().length)return r(new Error("options.icns must not be empty if provided."))}if(void 0!==t.env){if("object"!=typeof t.env)return r(new Error("options.env must be an object if provided."));if(0===Object.keys(t.env).length)return r(new Error("options.env must not be empty if provided."));for(var i in t.env){var o=t.env[i];if("string"!=typeof i||"string"!=typeof o)return r(new Error("options.env environment variables must be strings."));if(!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(i))return r(new Error("options.env has an invalid environment variable name: "+JSON.stringify(i)));if(/[\r\n]/.test(o))return r(new Error("options.env has an invalid environment variable value: "+JSON.stringify(o)))}}var a=Gn.process.platform;if("darwin"!==a&&"linux"!==a&&"win32"!==a)return r(new Error("Platform not yet supported."));var A={command:e,options:t,uuid:void 0,path:void 0};Hn(A,r)};var _n="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",es="User did not grant permission.",ts="No polkit authentication agent found.",rs=134217728;class ns{constructor(e,t,r,n,s,i,o,a,A,h={files:{}}){this.statusCallback=e,this.updaterName=t,this.version=r,this.exePath=n,this.tempDirectory=s,this.updateConfigName=i,this.updateJson=o,this.baseUrl=a,this.downloadFn=A,this.options=h,this.__diffResult=void 0}async checkForUpdates(){try{p(this.tempDirectory)||f(this.tempDirectory);const e=process.noAsar;if(Zn.gt(this.updateJson.version,this.version)){process.noAsar=!0;const e=ce(i(this.exePath),this.options);fe(e);const t=de(e,this.updateJson.hash);return d(s(this.tempDirectory,this.updateConfigName+".json"),JSON.stringify(t,null,2)),t&&t.added.concat(t.changed).length>0&&(this.__diffResult=Object.freeze(t)),t.added.concat(t.changed).length}return process.noAsar=e,0}catch(e){return this.statusCallback({message:e,status:"failed"}),0}}async downloadUpdate(){if(!this.__diffResult)return this.statusCallback({message:"程序无须更新",status:"failed"}),!1;try{p(this.tempDirectory)||f(this.tempDirectory),this.baseUrl.endsWith("/")||(this.baseUrl+="/");return new Promise(((e,t)=>{const r=new he(1,(()=>{e(!0)}));this.__diffResult.added.concat(this.__diffResult.changed).forEach((e=>{const t=`${this.baseUrl}${e.hash}.gz`;this.statusCallback({message:t,status:"init"}),r.addTask({task:()=>we(e.hash,t,s(this.tempDirectory,e.hash),this.downloadFn),taskReject:t=>{this.statusCallback({message:{url:e.hash,status:-1},status:"download"})},taskReslove:t=>{this.statusCallback({message:{url:e.hash,status:1},status:"download"})}})}))}))}catch(e){return this.statusCallback({message:e,status:"failed"}),!1}}sudoInstall(){return new Promise(((e,t)=>{zn.exec(this.updaterName,{env:{exe_path:this.exePath,update_temp_path:this.tempDirectory,update_config_file_name:this.updateConfigName+".json",exe_pid:process.pid.toString(),UPDATE_RUN_ADMIN:"1"},name:this.updaterName},(r=>{r?t(r):e(!0)}))}))}normalInstall(){return g(this.updaterName,{detached:!0,env:{exe_path:this.exePath,update_temp_path:this.tempDirectory,update_config_file_name:this.updateConfigName+".json",exe_pid:process.pid.toString()},stdio:"ignore"}),!0}async install(e=!1,t=!0){try{return e||!await this.validateDiffPackageIntegrity()?t?this.sudoInstall():this.normalInstall():(this.statusCallback({message:"Installation check difference failed",status:"failed"}),!1)}catch(e){return this.statusCallback({message:e,status:"failed"}),!1}}async validateDiffPackageIntegrity(){if(this.__diffResult){for(const e of this.__diffResult.changed){const t=`${this.tempDirectory}/${e.hash}`;if(!await ge(t,e.hash))return!0}for(const e of this.__diffResult.added){const t=`${this.tempDirectory}/${e.hash}`;if(!await ge(t,e.hash))return!0}}return!1}}export{oe as DiffVersionHashResult,ie as DiffVersionHashResultItem,ne as HashedFile,se as HashedFolder,ns as UpdateElectron,ae as UpdateInfo,Ae as UpdateStatus,ge as checkFileExitAndHash,de as diffVersionHash,we as downAndungzip,ve as gzip,fe as handleHashedFolderChildrenToObject,le as hash256,ce as hashElement,pe as hashElementPromiseQueue,me as pushdiffVersionHashResult,ue as reduceGlobPatterns,Ee as zipHashElement};
